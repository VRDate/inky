<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inky Player â€” Unity WebGL</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #1a1a2e; color: #eee; font-family: system-ui, sans-serif; }
    #unity-container { width: 100vw; height: 100vh; position: relative; }
    #unity-canvas { width: 100%; height: 100%; }
    /* OneJS renders React app into DOM alongside Unity canvas */
    #ink-editor-root { position: absolute; top: 0; left: 0; z-index: 10; pointer-events: none; }
    #ink-editor-root.active { pointer-events: auto; }
    .loading { display: flex; align-items: center; justify-content: center; height: 100vh; font-size: 1.2em; }
  </style>
</head>
<body>
  <div id="unity-container">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
    <!-- OneJS renders React components (Remirror + CodeMirror + InkPlayer) here -->
    <div id="ink-editor-root"></div>
  </div>

  <div id="loading" class="loading">Loading Inky Player...</div>

  <script>
    // Unity WebGL loader
    var buildUrl = "Build";
    var loaderUrl = buildUrl + "/{{{ LOADER_FILENAME }}}";
    var config = {
      dataUrl: buildUrl + "/{{{ DATA_FILENAME }}}",
      frameworkUrl: buildUrl + "/{{{ FRAMEWORK_FILENAME }}}",
      codeUrl: buildUrl + "/{{{ CODE_FILENAME }}}",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "{{{ COMPANY_NAME }}}",
      productName: "{{{ PRODUCT_NAME }}}",
      productVersion: "{{{ PRODUCT_VERSION }}}",
    };

    var script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = function() {
      createUnityInstance(document.querySelector("#unity-canvas"), config, function(progress) {
        document.getElementById("loading").textContent =
          "Loading... " + Math.round(progress * 100) + "%";
      }).then(function(unityInstance) {
        document.getElementById("loading").style.display = "none";
        // OneJS will register __inkBridge and load React app
        console.log("[InkyPlayer] Unity WebGL loaded. OneJS React app ready.");
      }).catch(function(message) {
        console.error("[InkyPlayer] Unity load error:", message);
      });
    };
    document.body.appendChild(script);
  </script>
</body>
</html>
