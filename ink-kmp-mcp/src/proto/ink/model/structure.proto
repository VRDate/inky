syntax = "proto3";
package ink.model;

option csharp_namespace = "Ink.Cs.Model";

// Ink source structure types.
// Replaces: KT InkSection/InkVariable/InkStructure/DivertRef.
// Maps to: C# Container/Divert/Path concepts.

enum SectionType {
  SECTION_TYPE_UNSPECIFIED = 0;
  KNOT = 1;
  STITCH = 2;
  FUNCTION = 3;
  PREAMBLE = 4;
}

message Section {
  string name = 1;
  SectionType type = 2;
  int32 start_line = 3;
  int32 end_line = 4;
  string content = 5;
  string parent = 6;
  repeated string parameters = 7;
  int32 line_count = 8;           // end_line - start_line
}

enum VariableType {
  VARIABLE_TYPE_UNSPECIFIED = 0;
  VAR = 1;
  CONST = 2;
  LIST = 3;
  TEMP = 4;
}

message Variable {
  string name = 1;
  VariableType type = 2;
  string initial_value = 3;
  int32 line = 4;
}

message DivertRef {
  string target = 1;
  int32 line = 2;
  int32 column = 3;
}

message Structure {
  repeated Section sections = 1;
  repeated Variable variables = 2;
  repeated string includes = 3;
  repeated DivertRef diverts = 4;
  int32 total_lines = 5;
  int32 divert_count = 6;        // len(diverts) â€” convenience field
}

// Ink choice from Ink2PumlEngine
message InkDiagramChoice {
  string text = 1;
  string divert = 2;
  bool is_sticky_choice = 3;
}

enum DiagramMode {
  DIAGRAM_MODE_UNSPECIFIED = 0;
  ACTIVITY = 1;
  STATE = 2;
}
